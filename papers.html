<script>
    async function loadPapers() {
        const papersList = document.getElementById('papersList');
        
        // Show loading state
        papersList.innerHTML = '<p>Loading papers...</p>';
        
        try {
            const response = await fetch('data/papers.json');
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const data = await response.json();
            
            // Update last updated time
            const lastUpdated = new Date(data.last_updated);
            document.getElementById('lastUpdated').textContent = 
                `Last updated: ${lastUpdated.toLocaleString()}`;
            
            // Create paper elements
            papersList.innerHTML = ''; // Clear existing content
            
            if (!data.papers || data.papers.length === 0) {
                papersList.innerHTML = '<p>No papers found. Please check back later.</p>';
                return;
            }
            
            data.papers.forEach(paper => {
                const paperElement = document.createElement('div');
                paperElement.className = 'paper';
                
                paperElement.innerHTML = `
                    <h2>${paper.title}</h2>
                    <div class="paper-meta">
                        <strong>Authors:</strong> ${paper.authors.join(', ')}
                        <br>
                        <strong>Published:</strong> ${new Date(paper.published).toLocaleDateString()}
                    </div>
                    <div class="paper-abstract">
                        ${paper.abstract}
                    </div>
                    <div class="paper-links">
                        <a href="${paper.pdf_url}" target="_blank">PDF</a>
                        <a href="${paper.arxiv_url}" target="_blank">arXiv</a>
                    </div>
                `;
                
                papersList.appendChild(paperElement);
            });
        } catch (error) {
            console.error('Error loading papers:', error);
            papersList.innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <p>Error loading papers. The GitHub Action might still be running to generate the data.</p>
                    <p>Please check back in a few minutes.</p>
                    <button onclick="loadPapers()" style="margin-top: 10px; padding: 8px 16px; background: #2a9d8f; color: white; border: none; border-radius: 4px; cursor: pointer;">
                        Try Again
                    </button>
                </div>`;
        }
    }

    // Load papers when page loads
    document.addEventListener('DOMContentLoaded', loadPapers);